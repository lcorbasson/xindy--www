<!-- MHonArc v2.4.4 -->
<!--X-Subject: Re: Xindy 1.2.1 and Allegro Common&#45;Lisp (was: Xindy and Allegro Common&#45;Lisp) -->
<!--X-From-R13: Preaq Dnvpuyr <envpuyrNWasbezngvx.Gav&#45;Eghggtneg.RS> -->
<!--X-Date: Fri, 21 Mar 1997 11:51:51 +0100 -->
<!--X-Message-Id: 199703211049.LAA28180@isle.informatik.uni&#45;stuttgart.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 199703201624.RAA13334@spock.iti.informatik.th&#45;darmstadt.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-L</TITLE>
<LINK REV="made" HREF="mailto:raichle@Informatik.Uni-Stuttgart.DE">
</HEAD>
<BODY BGCOLOR="white">
    <a href="../">
    <img style="border-style: none" src="../images/xindy-image.gif" alt="Book logo">
	    <img style="border-style: none" src="../images/xindy-logo-bw.gif" alt="xindy">
    </a>
    <p>
    <img style="border-style: none" src="../images/xindy-subtitle-bw.gif" alt="A Flexible Indexing System"></p>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00027.html">Date Prev</A>][<A HREF="msg00029.html">Date Next</A>][<A HREF="msg00027.html">Thread Prev</A>][<A HREF="msg00029.html">Thread Next</A>][<A HREF="maillist.html#00028">Date Index</A>][<A HREF="threads.html#00028">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</H1>
<HR>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<UL>
<LI><em>To</em>: <A HREF="mailto:xindy@iti.informatik.th-darmstadt.de">xindy@iti.informatik.th-darmstadt.de</A></LI>
<LI><em>Subject</em>: Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</LI>
<LI><em>From</em>: Bernd Raichle &lt;<A HREF="mailto:raichle@Informatik.Uni-Stuttgart.DE">raichle@Informatik.Uni-Stuttgart.DE</A>&gt;</LI>
<LI><em>Date</em>: Fri, 21 Mar 1997 11:49:52 +0100 (MET)</LI>
<LI><em>In-reply-to</em>: &lt;<A HREF="msg00027.html">199703201624.RAA13334@spock.iti.informatik.th-darmstadt.de</A>&gt;(message from Roger Kehr on Thu, 20 Mar 1997 17:24:31 +0100 (MEZ))</LI>
<LI><em>Reply-To</em>: <A HREF="mailto:xindy@iti.informatik.th-darmstadt.de">xindy@iti.informatik.th-darmstadt.de</A></LI>
<LI><em>Sender</em>: <A HREF="mailto:owner-xindy@iti.informatik.th-darmstadt.de">owner-xindy@iti.informatik.th-darmstadt.de</A></LI>
</UL>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Roger Kehr &lt;kehr@iti.informatik.th-darmstadt.de&gt; wrote:
: Bernd Raichle wrote:
[...]
: &gt; Can you explain what the differences beetwen ``:input'' and
: &gt; ``:input-immutable'' are?
: 
: I borrowed this from the implementation of function `load' int the
: CLISP-source :) I never asked if it is standard.

Bad practice!  Better change the :direction option of `open' option to
the standard `:input'.


[...]
: &gt; - "markup.lsp"
: &gt;
: &gt;   When opening the `logfile' in function `do-startup' add the
: &gt;   keyword/value
: &gt;         :if-exists :overwrite
: &gt;   to the `open' function call.  The default for :if-exists is :error,
: &gt;   i.e. signal an error if file to be written exists.
: &gt;
: &gt;   Same change needed when opening the `output' file in this function.
: 
: CLISP did never report an error :)

This is a bug in CLISP (or the Lisp standard has changed once more?).
Allegro CL reports an error if the log file existed which is the
standard behaviour.



[...]
: &gt; [...]
: &gt; ;  Note: Closure (:INTERNAL SPLIT-LIST 1) will be stack allocated.
: &gt; ;  Note: Closure (:INTERNAL SPLIT-LIST 0) will be stack allocated.
: &gt; [...]
: 
: Are these messages something important or can they be ignored?

These are only notices---no warning, no errors.
(Look in CLtL2 for more about "stack allocation".)


[...]
: What about the (system::getenv "XINDY_SEARCHPATH") call in
: set-searchpath-by-environment? Does it work on Allegro?

Ugh, no.

Allegro has a `getenv' function in package `sys', i.e.
(sys:getenv "XINDY_SEARCHPATH") will work.



: &gt; %%%%%%%%%%%%%%%%%%%%
: &gt;
: &gt; After compiling all files and fixed these two remaining bugs, I tried
: &gt; the test again:
[...]
: &gt; ERROR:
: &gt; Syntax Error in
: &gt;        (MARKUP-RANGE :CLASS "follows" :OPEN "\\folone{" :CLOSE "}f." :LENGTH 1
: &gt;                      :IGNORE-END).; killing "Editor Server"
: &gt; ; Exiting Lisp
: &gt;
: &gt;
: &gt; Any hints?  Any hints how to trace/debug Xindy to find this bug?
: 
: Hm. Best would be to directly trace the (markup-trace)-macro.
: 
: This error message is generated by the
: (desctructuring-swith-bind)-macro in idxstyle.lsp (intface.nw). It
: preprocesses a macro-call and removes any switches (&amp;switch) form the
: lambda-list. The remaining-list is simply passed to a
: (destructuring-bind) that for some reason has failed.
: 
: Try the following:
: 
: (LET
:     ((&lt;DESTRUCTURING-SWITCH-FORM&gt;
:       '(:CLASS "follows" :OPEN "folone{" :CLOSE "}f." :LENGTH 1
: 	:IGNORE-END
: 	))   )
:   (LET ((IGNORE-END (FIND :IGNORE-END &lt;DESTRUCTURING-SWITCH-FORM&gt;)))
:     (DESTRUCTURING-BIND (&amp;KEY OPEN CLOSE SEP CLASS LENGTH)
: 	(SET-DIFFERENCE &lt;DESTRUCTURING-SWITCH-FORM&gt; '(:IGNORE-END))
:       (LIST OPEN CLOSE SEP CLASS LENGTH
: 	    IGNORE-END))))
: 
: if it returns
: 
: -&gt; ("folone{" "}f." NIL "follows" 1 :IGNORE-END)

No, it signals the following error (if done in the IDXSTYLE package):


Error: keyword list (1 :LENGTH "}f." :CLOSE "folone{" :OPEN "follows" :CLASS)
       should only contain keys (:LENGTH :CLASS :SEP :CLOSE :OPEN)
  [condition type: PROGRAM-ERROR]

which seems to be the cause of the bug.
Something has reversed the given keyword list....


: Then you can try interactively
: 
: (macroexpand
:  '(intface:destructuring-switch-bind (&amp;key
: 				      open close sep class length
: 				      &amp;switch ignore-end)
:    '(:class "follows" :open "\folone{" :close "}f."
:      :length 1 :ignore-end)
:    (list open close sep class length ignore-end)))
: 
: if it returns the above expansion.

It returns

(LET ((&lt;DESTRUCTURING-SWITCH-FORM&gt;
       '(:CLASS "follows" :OPEN "folone{" :CLOSE "}f." :LENGTH 1
         :IGNORE-END)))
  (LET ((IGNORE-END (FIND :IGNORE-END &lt;DESTRUCTURING-SWITCH-FORM&gt;)))
    (HANDLER-CASE (DESTRUCTURING-BIND (&amp;KEY OPEN CLOSE SEP CLASS LENGTH)
                                      (SET-DIFFERENCE
                                       &lt;DESTRUCTURING-SWITCH-FORM&gt;
                                       '(:IGNORE-END))
                                      (LIST
                                       OPEN
                                       CLOSE
                                       SEP
                                       CLASS
                                       LENGTH
                                       IGNORE-END))
                  (ERROR (COND) (DECLARE (IGNORE COND))
                         (ERROR "~&amp;Syntax Error in ~S." WHOLE)))))

which is almost the same as your shown code except of the additional
`handler-case'.

-bernd

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00029" HREF="msg00029.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
<UL><LI><EM>From:</EM> Roger Kehr &lt;kehr@iti.informatik.th-darmstadt.de&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00027" HREF="msg00027.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
<UL><LI><EM>From:</EM> Roger Kehr &lt;kehr@iti.informatik.th-darmstadt.de&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00027.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00029.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00027.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00029.html">Re: Xindy 1.2.1 and Allegro Common-Lisp (was: Xindy and Allegro Common-Lisp)</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00028"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00028"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
